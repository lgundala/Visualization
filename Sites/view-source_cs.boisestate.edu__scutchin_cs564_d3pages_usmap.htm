
<!-- saved from url=(0059)http://cs.boisestate.edu/~scutchin/cs564/d3pages/usmap.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><div class="line-gutter-backdrop"></div><table><tbody><tr><td class="line-number" value="1"></td><td class="line-content"><span class="html-doctype">&lt;!DOCTYPE html&gt;</span></td></tr><tr><td class="line-number" value="2"></td><td class="line-content"><span class="html-tag">&lt;html <span class="html-attribute-name">lang</span>="<span class="html-attribute-value">en</span>"&gt;</span></td></tr><tr><td class="line-number" value="3"></td><td class="line-content"><span class="html-tag">&lt;head&gt;</span></td></tr><tr><td class="line-number" value="4"></td><td class="line-content"><span class="html-tag">&lt;meta <span class="html-attribute-name">charset</span>="<span class="html-attribute-value">utf-8</span>"&gt;</span></td></tr><tr><td class="line-number" value="5"></td><td class="line-content"><span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://d3js.org/d3.v3.min.js">http://d3js.org/d3.v3.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="6"></td><td class="line-content"><span class="html-tag">&lt;style <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>"&gt;</span></td></tr><tr><td class="line-number" value="7"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="8"></td><td class="line-content">/* On mouse hover, lighten state color */</td></tr><tr><td class="line-number" value="9"></td><td class="line-content">path:hover {</td></tr><tr><td class="line-number" value="10"></td><td class="line-content">	fill-opacity: .7;</td></tr><tr><td class="line-number" value="11"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="12"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="13"></td><td class="line-content">/* Style for Custom Tooltip */</td></tr><tr><td class="line-number" value="14"></td><td class="line-content">div.tooltip {   </td></tr><tr><td class="line-number" value="15"></td><td class="line-content"> 	position: absolute;           </td></tr><tr><td class="line-number" value="16"></td><td class="line-content">	text-align: center;           </td></tr><tr><td class="line-number" value="17"></td><td class="line-content">	width: 60px;                  </td></tr><tr><td class="line-number" value="18"></td><td class="line-content">	height: 28px;                 </td></tr><tr><td class="line-number" value="19"></td><td class="line-content">	padding: 2px;             </td></tr><tr><td class="line-number" value="20"></td><td class="line-content">	font: 12px sans-serif;        </td></tr><tr><td class="line-number" value="21"></td><td class="line-content">	background: white;   </td></tr><tr><td class="line-number" value="22"></td><td class="line-content">	border: 0px;      </td></tr><tr><td class="line-number" value="23"></td><td class="line-content">	border-radius: 8px;           </td></tr><tr><td class="line-number" value="24"></td><td class="line-content">	pointer-events: none;         </td></tr><tr><td class="line-number" value="25"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="26"></td><td class="line-content">        </td></tr><tr><td class="line-number" value="27"></td><td class="line-content">/* Legend Font Style */</td></tr><tr><td class="line-number" value="28"></td><td class="line-content">body {</td></tr><tr><td class="line-number" value="29"></td><td class="line-content">	font: 11px sans-serif;</td></tr><tr><td class="line-number" value="30"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="31"></td><td class="line-content">        </td></tr><tr><td class="line-number" value="32"></td><td class="line-content">/* Legend Position Style */</td></tr><tr><td class="line-number" value="33"></td><td class="line-content">.legend {</td></tr><tr><td class="line-number" value="34"></td><td class="line-content">	position:absolute;</td></tr><tr><td class="line-number" value="35"></td><td class="line-content">	left:800px;</td></tr><tr><td class="line-number" value="36"></td><td class="line-content">	top:350px;</td></tr><tr><td class="line-number" value="37"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="38"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="39"></td><td class="line-content"><span class="html-tag">&lt;/style&gt;</span></td></tr><tr><td class="line-number" value="40"></td><td class="line-content"><span class="html-tag">&lt;/head&gt;</span></td></tr><tr><td class="line-number" value="41"></td><td class="line-content"><span class="html-tag">&lt;body&gt;</span></td></tr><tr><td class="line-number" value="42"></td><td class="line-content"><span class="html-tag">&lt;script <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/javascript</span>"&gt;</span></td></tr><tr><td class="line-number" value="43"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="44"></td><td class="line-content">/*  This visualization was made possible by modifying code provided by:</td></tr><tr><td class="line-number" value="45"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="46"></td><td class="line-content">Scott Murray, Choropleth example from "Interactive Data Visualization for the Web" </td></tr><tr><td class="line-number" value="47"></td><td class="line-content">https://github.com/alignedleft/d3-book/blob/master/chapter_12/05_choropleth.html   </td></tr><tr><td class="line-number" value="48"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="49"></td><td class="line-content">Malcolm Maclean, tooltips example tutorial</td></tr><tr><td class="line-number" value="50"></td><td class="line-content">http://www.d3noob.org/2013/01/adding-tooltips-to-d3js-graph.html</td></tr><tr><td class="line-number" value="51"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="52"></td><td class="line-content">Mike Bostock, Pie Chart Legend</td></tr><tr><td class="line-number" value="53"></td><td class="line-content">http://bl.ocks.org/mbostock/3888852  */</td></tr><tr><td class="line-number" value="54"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="55"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="56"></td><td class="line-content">//Width and height of map</td></tr><tr><td class="line-number" value="57"></td><td class="line-content">var width = 960;</td></tr><tr><td class="line-number" value="58"></td><td class="line-content">var height = 500;</td></tr><tr><td class="line-number" value="59"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="60"></td><td class="line-content">// D3 Projection</td></tr><tr><td class="line-number" value="61"></td><td class="line-content">var projection = d3.geo.albersUsa()</td></tr><tr><td class="line-number" value="62"></td><td class="line-content">				   .translate([width/2, height/2])    // translate to center of screen</td></tr><tr><td class="line-number" value="63"></td><td class="line-content">				   .scale([1000]);          // scale things down so see entire US</td></tr><tr><td class="line-number" value="64"></td><td class="line-content">        </td></tr><tr><td class="line-number" value="65"></td><td class="line-content">// Define path generator</td></tr><tr><td class="line-number" value="66"></td><td class="line-content">var path = d3.geo.path()               // path generator that will convert GeoJSON to SVG paths</td></tr><tr><td class="line-number" value="67"></td><td class="line-content">		  	 .projection(projection);  // tell path generator to use albersUsa projection</td></tr><tr><td class="line-number" value="68"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="69"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="70"></td><td class="line-content">// Define linear scale for output</td></tr><tr><td class="line-number" value="71"></td><td class="line-content">var color = d3.scale.linear()</td></tr><tr><td class="line-number" value="72"></td><td class="line-content">			  .range(["rgb(213,222,217)","rgb(69,173,168)","rgb(84,36,55)","rgb(217,91,67)"]);</td></tr><tr><td class="line-number" value="73"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="74"></td><td class="line-content">var legendText = ["Legend1", "Legend1", "Legend2", "Legend2"];</td></tr><tr><td class="line-number" value="75"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="76"></td><td class="line-content">//Create SVG element and append map to the SVG</td></tr><tr><td class="line-number" value="77"></td><td class="line-content">var svg = d3.select("body")</td></tr><tr><td class="line-number" value="78"></td><td class="line-content">			.append("svg")</td></tr><tr><td class="line-number" value="79"></td><td class="line-content">			.attr("width", width)</td></tr><tr><td class="line-number" value="80"></td><td class="line-content">			.attr("height", height);</td></tr><tr><td class="line-number" value="81"></td><td class="line-content">        </td></tr><tr><td class="line-number" value="82"></td><td class="line-content">// Append Div for tooltip to SVG</td></tr><tr><td class="line-number" value="83"></td><td class="line-content">var div = d3.select("body")</td></tr><tr><td class="line-number" value="84"></td><td class="line-content">		    .append("div")   </td></tr><tr><td class="line-number" value="85"></td><td class="line-content">    		.attr("class", "tooltip")               </td></tr><tr><td class="line-number" value="86"></td><td class="line-content">    		.style("opacity", 0);</td></tr><tr><td class="line-number" value="87"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="88"></td><td class="line-content">// Load in my states data!</td></tr><tr><td class="line-number" value="89"></td><td class="line-content">d3.csv("stateslived.csv", function(data) {</td></tr><tr><td class="line-number" value="90"></td><td class="line-content">color.domain([0,1,2,3]); // setting the range of the input data</td></tr><tr><td class="line-number" value="91"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="92"></td><td class="line-content">// Load GeoJSON data and merge with states data</td></tr><tr><td class="line-number" value="93"></td><td class="line-content">d3.json("us-states.json", function(json) {</td></tr><tr><td class="line-number" value="94"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="95"></td><td class="line-content">// Loop through each state data value in the .csv file</td></tr><tr><td class="line-number" value="96"></td><td class="line-content">for (var i = 0; i &lt; data.length; i++) {</td></tr><tr><td class="line-number" value="97"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="98"></td><td class="line-content">	// Grab State Name</td></tr><tr><td class="line-number" value="99"></td><td class="line-content">	var dataState = data[i].state;</td></tr><tr><td class="line-number" value="100"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="101"></td><td class="line-content">	// Grab data value </td></tr><tr><td class="line-number" value="102"></td><td class="line-content">	var dataValue = data[i].visited;</td></tr><tr><td class="line-number" value="103"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="104"></td><td class="line-content">	// Find the corresponding state inside the GeoJSON</td></tr><tr><td class="line-number" value="105"></td><td class="line-content">	for (var j = 0; j &lt; json.features.length; j++)  {</td></tr><tr><td class="line-number" value="106"></td><td class="line-content">		var jsonState = json.features[j].properties.name;</td></tr><tr><td class="line-number" value="107"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="108"></td><td class="line-content">		if (dataState == jsonState) {</td></tr><tr><td class="line-number" value="109"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="110"></td><td class="line-content">		// Copy the data value into the JSON</td></tr><tr><td class="line-number" value="111"></td><td class="line-content">		json.features[j].properties.visited = dataValue; </td></tr><tr><td class="line-number" value="112"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="113"></td><td class="line-content">		// Stop looking through the JSON</td></tr><tr><td class="line-number" value="114"></td><td class="line-content">		break;</td></tr><tr><td class="line-number" value="115"></td><td class="line-content">		}</td></tr><tr><td class="line-number" value="116"></td><td class="line-content">	}</td></tr><tr><td class="line-number" value="117"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="118"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="119"></td><td class="line-content">// Bind the data to the SVG and create one path per GeoJSON feature</td></tr><tr><td class="line-number" value="120"></td><td class="line-content">svg.selectAll("path")</td></tr><tr><td class="line-number" value="121"></td><td class="line-content">	.data(json.features)</td></tr><tr><td class="line-number" value="122"></td><td class="line-content">	.enter()</td></tr><tr><td class="line-number" value="123"></td><td class="line-content">	.append("path")</td></tr><tr><td class="line-number" value="124"></td><td class="line-content">	.attr("d", path)</td></tr><tr><td class="line-number" value="125"></td><td class="line-content">	.style("stroke", "#fff")</td></tr><tr><td class="line-number" value="126"></td><td class="line-content">	.style("stroke-width", "1")</td></tr><tr><td class="line-number" value="127"></td><td class="line-content">	.style("fill", function(d) {</td></tr><tr><td class="line-number" value="128"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="129"></td><td class="line-content">	// Get data value</td></tr><tr><td class="line-number" value="130"></td><td class="line-content">	var value = d.properties.visited;</td></tr><tr><td class="line-number" value="131"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="132"></td><td class="line-content">	if (value) {</td></tr><tr><td class="line-number" value="133"></td><td class="line-content">	//If value exists…</td></tr><tr><td class="line-number" value="134"></td><td class="line-content">	return color(value);</td></tr><tr><td class="line-number" value="135"></td><td class="line-content">	} else {</td></tr><tr><td class="line-number" value="136"></td><td class="line-content">	//If value is undefined…</td></tr><tr><td class="line-number" value="137"></td><td class="line-content">	return "rgb(213,222,217)";</td></tr><tr><td class="line-number" value="138"></td><td class="line-content">	}</td></tr><tr><td class="line-number" value="139"></td><td class="line-content">});</td></tr><tr><td class="line-number" value="140"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="141"></td><td class="line-content">		 </td></tr><tr><td class="line-number" value="142"></td><td class="line-content">// Map the cities I have lived in!</td></tr><tr><td class="line-number" value="143"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="144"></td><td class="line-content">/*d3.csv("cities-lived.csv", function(data) {</td></tr><tr><td class="line-number" value="145"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="146"></td><td class="line-content">svg.selectAll("circle")</td></tr><tr><td class="line-number" value="147"></td><td class="line-content">	.data(data)</td></tr><tr><td class="line-number" value="148"></td><td class="line-content">	.enter()</td></tr><tr><td class="line-number" value="149"></td><td class="line-content">	.append("circle")</td></tr><tr><td class="line-number" value="150"></td><td class="line-content">	.attr("cx", function(d) {</td></tr><tr><td class="line-number" value="151"></td><td class="line-content">		return projection([d.lon, d.lat])[0];</td></tr><tr><td class="line-number" value="152"></td><td class="line-content">	})</td></tr><tr><td class="line-number" value="153"></td><td class="line-content">	.attr("cy", function(d) {</td></tr><tr><td class="line-number" value="154"></td><td class="line-content">		return projection([d.lon, d.lat])[1];</td></tr><tr><td class="line-number" value="155"></td><td class="line-content">	})</td></tr><tr><td class="line-number" value="156"></td><td class="line-content">	.attr("r", function(d) {</td></tr><tr><td class="line-number" value="157"></td><td class="line-content">		return Math.sqrt(d.years) * 4;</td></tr><tr><td class="line-number" value="158"></td><td class="line-content">	})</td></tr><tr><td class="line-number" value="159"></td><td class="line-content">		.style("fill", "rgb(217,91,67)")	</td></tr><tr><td class="line-number" value="160"></td><td class="line-content">		.style("opacity", 0.85)	</td></tr><tr><td class="line-number" value="161"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="162"></td><td class="line-content">	// Modification of custom tooltip code provided by Malcolm Maclean, "D3 Tips and Tricks" </td></tr><tr><td class="line-number" value="163"></td><td class="line-content">	// http://www.d3noob.org/2013/01/adding-tooltips-to-d3js-graph.html</td></tr><tr><td class="line-number" value="164"></td><td class="line-content">	.on("mouseover", function(d) {      </td></tr><tr><td class="line-number" value="165"></td><td class="line-content">    	div.transition()        </td></tr><tr><td class="line-number" value="166"></td><td class="line-content">      	   .duration(200)      </td></tr><tr><td class="line-number" value="167"></td><td class="line-content">           .style("opacity", .9);      </td></tr><tr><td class="line-number" value="168"></td><td class="line-content">           div.text(d.place)</td></tr><tr><td class="line-number" value="169"></td><td class="line-content">           .style("left", (d3.event.pageX) + "px")     </td></tr><tr><td class="line-number" value="170"></td><td class="line-content">           .style("top", (d3.event.pageY - 28) + "px");    </td></tr><tr><td class="line-number" value="171"></td><td class="line-content">	})   </td></tr><tr><td class="line-number" value="172"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="173"></td><td class="line-content">    // fade out tooltip on mouse out               </td></tr><tr><td class="line-number" value="174"></td><td class="line-content">    .on("mouseout", function(d) {       </td></tr><tr><td class="line-number" value="175"></td><td class="line-content">        div.transition()        </td></tr><tr><td class="line-number" value="176"></td><td class="line-content">           .duration(500)      </td></tr><tr><td class="line-number" value="177"></td><td class="line-content">           .style("opacity", 0);   </td></tr><tr><td class="line-number" value="178"></td><td class="line-content">    });</td></tr><tr><td class="line-number" value="179"></td><td class="line-content">});</td></tr><tr><td class="line-number" value="180"></td><td class="line-content">*/  </td></tr><tr><td class="line-number" value="181"></td><td class="line-content">        </td></tr><tr><td class="line-number" value="182"></td><td class="line-content">// Modified Legend Code from Mike Bostock: http://bl.ocks.org/mbostock/3888852</td></tr><tr><td class="line-number" value="183"></td><td class="line-content">var legend = d3.select("body").append("svg")</td></tr><tr><td class="line-number" value="184"></td><td class="line-content">      			.attr("class", "legend")</td></tr><tr><td class="line-number" value="185"></td><td class="line-content">     			.attr("width", 140)</td></tr><tr><td class="line-number" value="186"></td><td class="line-content">    			.attr("height", 200)</td></tr><tr><td class="line-number" value="187"></td><td class="line-content">   				.selectAll("g")</td></tr><tr><td class="line-number" value="188"></td><td class="line-content">   				.data(color.domain().slice().reverse())</td></tr><tr><td class="line-number" value="189"></td><td class="line-content">   				.enter()</td></tr><tr><td class="line-number" value="190"></td><td class="line-content">   				.append("g")</td></tr><tr><td class="line-number" value="191"></td><td class="line-content">     			.attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });</td></tr><tr><td class="line-number" value="192"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="193"></td><td class="line-content">  	legend.append("rect")</td></tr><tr><td class="line-number" value="194"></td><td class="line-content">   		  .attr("width", 18)</td></tr><tr><td class="line-number" value="195"></td><td class="line-content">   		  .attr("height", 18)</td></tr><tr><td class="line-number" value="196"></td><td class="line-content">   		  .style("fill", color);</td></tr><tr><td class="line-number" value="197"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="198"></td><td class="line-content">  	legend.append("text")</td></tr><tr><td class="line-number" value="199"></td><td class="line-content">  		  .data(legendText)</td></tr><tr><td class="line-number" value="200"></td><td class="line-content">      	  .attr("x", 24)</td></tr><tr><td class="line-number" value="201"></td><td class="line-content">      	  .attr("y", 9)</td></tr><tr><td class="line-number" value="202"></td><td class="line-content">      	  .attr("dy", ".35em")</td></tr><tr><td class="line-number" value="203"></td><td class="line-content">      	  .text(function(d) { return d; });</td></tr><tr><td class="line-number" value="204"></td><td class="line-content">	});</td></tr><tr><td class="line-number" value="205"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="206"></td><td class="line-content">});</td></tr><tr><td class="line-number" value="207"></td><td class="line-content"><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="208"></td><td class="line-content"><span class="html-tag">&lt;/body&gt;</span></td></tr><tr><td class="line-number" value="209"></td><td class="line-content"><span class="html-tag">&lt;/html&gt;</span><span class="html-end-of-file"></span></td></tr></tbody></table></body></html>